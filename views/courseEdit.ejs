<%- contentFor('content') %>-
<div class="container col-md-4 col-md-offset-4">
  <h1 class="text-center">Update Semester</h1>
  <form id="course_form"
    action="/courses/<%=encodeURIComponent(course.semester_name)%>/<%=encodeURIComponent(course.module_code)%>"
    role="form" method="post">
    <div class="form-group">
      <label for="name">Semester Name</label>
      <select class="form-control" id="semester_name" name="semester_name" required="required">
        <% for(var i=0; i<semesters.length; i++) { %>
        <% if (semesters[i].name === course.semester_name) { %>
        <option selected><%= semesters[i].name%></option>
        <% } else { %>
        <option><%= semesters[i].name%></option>
        <% } %>
        <% } %>
      </select>
    </div>
    <div class="form-group">
      <label for="name">Module Code</label>
      <select class="form-control" id="module_code" name="module_code" required="required"
        value="<%=course.module_code%>">
        <% for(var i=0; i<modules.length; i++) { %>
        <% if (modules[i].module_code === course.module_code) { %>
        <option selected><%= modules[i].module_code%></option>
        <% } else { %>
        <option><%= modules[i].module_code%></option>
        <% } %>
        <% } %>
      </select>
    </div>
    <div class="form-group">
      <label for="name">Title</label>
      <input type="text" class="form-control" id="title" name="title" required="required" value="<%=course.title%>">
    </div>
    <div class="form-group">
      <label for="name">Description</label>
      <input type="text" class="form-control" id="description" name="description" required="required"
        value="<%=course.description%>">
    </div>
    <div class="form-group">
      <label for="name">Credits</label>
      <input type="text" class="form-control" id="credits" name="credits" required="required"
        value="<%=course.credits%>">
    </div>

    <button type="submit" class="btn btn-primary">Update</button>
  </form>
</div>

<%- contentFor('script') %>
<script>
  $("#course_form").submit(function (e) {
    e.preventDefault(); // avoid to execute the actual submit of the form.
    var form = $(this);
    var url = form.attr('action');
    $.ajax({
      type: "PUT",
      url: url,
      data: form.serialize(), // serializes the form's elements.
      success: function (res) {
        if (res.error) {
          alert(res.error)
        } else {
          window.location = res.redirectUrl
        }
      }
    });
  });
</script>