<!DOCTYPE html>
<html>
  <head>
	<!-- Page Title -->
    <title>Users</title>
		<% include ./partials/head %>
	</head>
  <body>
		<header>
			<% include ./partials/header %>
		</header>
		<div class="container">
    <h1>Users</h1>
	<table class="table table-hover">
		<thead>
			<tr>
				<th scope="col">User ID</th>
				<th scope="col">Name</th>
				<th scope="col"></th>
				<th scope="col"></th>
			</tr>
		</thead>
		<tbody>
			<% for(var i=0; i<data.length; i++) { %>
			<tr>
				<td><%= data[i].id%></td>
				<td><%= data[i].name%></td>
				<td>
					<a href="/users/<%= data[i].id%>/edit">Edit</a>
				</td>
				<td>
					<button class="btn" name="delete" id="<%=data[i].id%>">
						<i class="fa fa-trash"></i>
					</button>
				</td>
			</tr>
			<% } %>
		</tbody>
	</table>
	</div>
	<footer>
		<% include ./partials/footer %>
	</footer>
	</body>
	<script>
			$("button[name='delete']").click(function () {
				$.ajax({
					url: '/users/' + `${ $(this).attr('id') }`,
					type: 'DELETE',
					success: function (res) {
						console.log("Successfully deleted user");
						window.location = res.redirectUrl
					},
					error: function () {
						console.log("Failed to delete user");
					}
				});
			});
	</script>
</html>
